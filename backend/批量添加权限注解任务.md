# 批量添加权限注解任务清单

## 已完成的控制器 ✅
1. SysUserController
2. RoleManagementController
3. RoomController
4. RoomBookingController
5. UserPermissionController
6. AuthenticationController
7. OrganizationController

## 待处理的控制器及权限配置

### 1. PositionController (职位管理)
```java
@GetMapping("/all") → @PreAuthorize("hasAuthority('POSITION_VIEW') or hasAuthority('POSITION_MANAGE')")
@PostMapping("/search") → @PreAuthorize("hasAuthority('POSITION_VIEW') or hasAuthority('POSITION_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('POSITION_VIEW') or hasAuthority('POSITION_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('POSITION_ADD') or hasAuthority('POSITION_MANAGE')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('POSITION_EDIT') or hasAuthority('POSITION_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('POSITION_DELETE') or hasAuthority('POSITION_MANAGE')")
```

### 2. TitleController (职称管理)
```java
@GetMapping("/all") → @PreAuthorize("hasAuthority('TITLE_VIEW') or hasAuthority('TITLE_MANAGE')")
@PostMapping("/search") → @PreAuthorize("hasAuthority('TITLE_VIEW') or hasAuthority('TITLE_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('TITLE_VIEW') or hasAuthority('TITLE_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('TITLE_ADD') or hasAuthority('TITLE_MANAGE')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('TITLE_EDIT') or hasAuthority('TITLE_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('TITLE_DELETE') or hasAuthority('TITLE_MANAGE')")
```

### 3. BlacklistController (黑名单管理)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('BLACKLIST_VIEW') or hasAuthority('BLACKLIST_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('BLACKLIST_VIEW') or hasAuthority('BLACKLIST_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('BLACKLIST_ADD') or hasAuthority('BLACKLIST_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('BLACKLIST_DELETE') or hasAuthority('BLACKLIST_MANAGE')")
@DeleteMapping("/batch") → @PreAuthorize("hasAuthority('BLACKLIST_DELETE') or hasAuthority('BLACKLIST_MANAGE')")
@GetMapping("/check-status") → @PreAuthorize("isAuthenticated()")
```

### 4. ViolationSettingController (违规设置)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('VIOLATION_MANAGE') or hasAuthority('SYSTEM_CONFIG')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('VIOLATION_MANAGE') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('VIOLATION_MANAGE') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/batch") → @PreAuthorize("hasAuthority('VIOLATION_MANAGE') or hasAuthority('SYSTEM_CONFIG')")
```

### 5. AreaController (区域管理)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('AREA_VIEW') or hasAuthority('AREA_MANAGE')")
@GetMapping("/tree") → @PreAuthorize("hasAuthority('AREA_VIEW') or hasAuthority('AREA_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('AREA_VIEW') or hasAuthority('AREA_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('AREA_ADD') or hasAuthority('AREA_MANAGE')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('AREA_EDIT') or hasAuthority('AREA_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('AREA_DELETE') or hasAuthority('AREA_MANAGE')")
```

### 6. BookingPersonnelPermissionController (预订人员权限)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@GetMapping("/available-users") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
@GetMapping("/available-rooms") → @PreAuthorize("hasAuthority('BOOKING_PERMISSION_MANAGE')")
```

### 7. ContinuousBookingSettingController (连续预订设置)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PostMapping → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/batch/update") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
```

### 8. UserBookingLimitController (用户预订限制)
```java
@GetMapping("/all") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PostMapping → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
```

### 9. BookingTimeRuleController (预订时间规则)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PostMapping → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('BOOKING_CONFIG') or hasAuthority('SYSTEM_CONFIG')")
```

### 10. BookingTimeValidationController (预订时间验证)
```java
@PostMapping("/validate") → @PreAuthorize("isAuthenticated()")
```

### 11. RecycleBinController (回收站)
```java
@GetMapping("/users") → @PreAuthorize("hasAuthority('RECYCLE_VIEW')")
@PostMapping("/users/restore") → @PreAuthorize("hasAuthority('RECYCLE_RESTORE')")
@DeleteMapping("/users/delete") → @PreAuthorize("hasAuthority('RECYCLE_DELETE')")
```

### 12. SchemeManagementController (方案管理)
```java
@PostMapping("/search") → @PreAuthorize("hasAuthority('SCHEME_VIEW') or hasAuthority('SCHEME_MANAGE')")
@GetMapping("/{id}") → @PreAuthorize("hasAuthority('SCHEME_VIEW') or hasAuthority('SCHEME_MANAGE')")
@PostMapping → @PreAuthorize("hasAuthority('SCHEME_ADD') or hasAuthority('SCHEME_MANAGE')")
@PutMapping("/{id}") → @PreAuthorize("hasAuthority('SCHEME_EDIT') or hasAuthority('SCHEME_MANAGE')")
@DeleteMapping("/{id}") → @PreAuthorize("hasAuthority('SCHEME_DELETE') or hasAuthority('SCHEME_MANAGE')")
@PostMapping("/{id}/activate") → @PreAuthorize("hasAuthority('SCHEME_EDIT') or hasAuthority('SCHEME_MANAGE')")
```

### 13. FileUploadController (文件上传)
```java
@PostMapping → @PreAuthorize("hasAuthority('FILE_UPLOAD')")
@PostMapping("/multiple") → @PreAuthorize("hasAuthority('FILE_UPLOAD')")
```

### 14. FileUploadEnhancedController (增强文件上传)
```java
@PostMapping("/enhanced") → @PreAuthorize("hasAuthority('FILE_UPLOAD') or hasAuthority('FILE_MANAGE')")
@PostMapping("/enhanced/check") → @PreAuthorize("hasAuthority('FILE_UPLOAD') or hasAuthority('FILE_MANAGE')")
@GetMapping("/enhanced/{fileId}") → @PreAuthorize("hasAuthority('FILE_UPLOAD') or hasAuthority('FILE_MANAGE')")
@DeleteMapping("/enhanced/{fileId}") → @PreAuthorize("hasAuthority('FILE_MANAGE')")
```

### 15. RoomScheduleController (教室日程)
```java
@PostMapping("/weekly") → @PreAuthorize("hasAuthority('ROOM_VIEW') or hasAuthority('BOOKING_VIEW')")
@PostMapping("/available-rooms") → @PreAuthorize("hasAuthority('ROOM_BOOK') or hasAuthority('BOOKING_CREATE')")
```

### 16. RoomBookingApprovalController (预订审批)
```java
@PostMapping("/pending") → @PreAuthorize("hasAuthority('BOOKING_APPROVE') or hasAuthority('BOOKING_MANAGE')")
@PostMapping("/history") → @PreAuthorize("hasAuthority('BOOKING_VIEW') or hasAuthority('BOOKING_MANAGE')")
@PostMapping("/approve") → @PreAuthorize("hasAuthority('BOOKING_APPROVE') or hasAuthority('BOOKING_MANAGE')")
@PostMapping("/reject") → @PreAuthorize("hasAuthority('BOOKING_REJECT') or hasAuthority('BOOKING_MANAGE')")
@PostMapping("/batch-approve") → @PreAuthorize("hasAuthority('BOOKING_APPROVE') or hasAuthority('BOOKING_MANAGE')")
@PostMapping("/batch-reject") → @PreAuthorize("hasAuthority('BOOKING_REJECT') or hasAuthority('BOOKING_MANAGE')")
```

## 注意事项
1. 所有控制器都需要添加 `import org.springframework.security.access.prepost.PreAuthorize;`
2. 公开接口（如登录、忘记密码）不需要权限注解
3. 仅需要登录的接口使用 `@PreAuthorize("isAuthenticated()")`
4. 需要特定权限的接口使用 `@PreAuthorize("hasAuthority('XXX')")`
5. 多个权限使用 `or` 连接