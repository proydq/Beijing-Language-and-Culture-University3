# 前端代理配置说明

## 一、代理配置概述

项目已配置开发环境代理，解决开发时的跨域问题。

### 配置文件位置
- `vite.config.js` - Vite 代理配置
- `.env.development` - 开发环境变量
- `.env.production` - 生产环境变量

## 二、代理规则

### 1. API 接口代理（带 /api 前缀）
- 匹配规则：`/api/**`
- 目标地址：`http://localhost:10086`
- 示例：`/api/room/list` → `http://localhost:10086/api/room/list`

### 2. 各模块接口代理（不带 /api 前缀）
所有不带 `/api` 前缀的后端接口都需要配置代理：

| 路径前缀 | 说明 | 示例 |
|---------|------|------|
| `/authentication` | 认证相关 | `/authentication/login` |
| `/area` | 区域管理 | `/area/tree` |
| `/blacklist` | 黑名单管理 | `/blacklist/search` |
| `/violation-settings` | 违规设置 | `/violation-settings/search` |
| `/booking-personnel-permission` | 预约权限 | `/booking-personnel-permission/list` |
| `/continuous-booking-settings` | 连续预约设置 | `/continuous-booking-settings/list` |
| `/user-booking-limits` | 用户预约限制 | `/user-booking-limits/all` |
| `/booking-time-rules` | 预约时间规则 | `/booking-time-rules/list` |
| `/booking-validation` | 预约验证 | `/booking-validation/check-time` |
| `/recycle-bin` | 回收站 | `/recycle-bin/stats` |
| `/role-management` | 角色管理 | `/role-management/list` |
| `/scheme-management` | 方案管理 | `/scheme-management/personnel/list` |
| `/system` | 系统用户 | `/system/user/delete` |

## 三、使用方式

### 开发环境
```javascript
// 之前（直接请求）
await axios.post('http://localhost:10086/api/room/create', data)

// 现在（通过代理）
await axios.post('/api/room/create', data)
```

### 生产环境
生产环境通常通过 nginx 配置反向代理，前端代码保持使用相对路径即可。

## 四、环境变量说明

### .env.development
```bash
VITE_API_BASE_URL=http://localhost:10086  # 后端服务地址
VITE_APP_PORT=5173                        # 开发服务器端口
```

### .env.production
```bash
VITE_API_BASE_URL=                        # 生产环境使用相对路径
VITE_APP_PORT=80                          # 生产环境端口
```

## 五、注意事项

1. **axios baseURL 配置**
   - 已修改为空字符串，使用相对路径
   - `request.js` 和 `api/index.js` 都已更新

2. **开发服务器重启**
   - 修改代理配置后需要重启开发服务器
   - 运行 `npm run dev` 重新启动

3. **浏览器缓存**
   - 配置修改后建议清除浏览器缓存
   - 或使用无痕模式测试

4. **网络请求检查**
   - 打开浏览器开发者工具
   - 在 Network 面板查看请求是否正确代理
   - 请求 URL 应该是相对路径，不含域名

## 六、常见问题

### 1. 代理不生效
- 确保重启了开发服务器
- 检查请求路径是否匹配代理规则
- 确认 axios 使用的是相对路径

### 2. 跨域错误
- 检查后端服务是否正常运行
- 确认代理目标地址正确
- 查看控制台错误信息

### 3. 生产环境部署
生产环境需要配置 nginx：
```nginx
location /api {
    proxy_pass http://backend-server:10086;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

location /authentication {
    proxy_pass http://backend-server:10086;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```